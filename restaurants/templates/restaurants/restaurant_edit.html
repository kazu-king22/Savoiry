{% extends "base.html" %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'restaurants/css/edit.css' %}">
{% endblock %}

{% block content %}
<div class="register-container">

  <h2>店舗情報を編集</h2>

  <form method="post">
    {% csrf_token %}

    <!-- 店名 -->
    <p>
      <label for="id_store_name">店名（必須）</label>
      <input type="text" id="id_store_name" name="store_name"
             value="{{ object.store_name }}">
    </p>

    <!-- URL -->
    <p>
      <label for="id_url">URL</label>
      <input type="text" id="id_url" name="url"
             value="{{ object.url|default_if_none:'' }}">
    </p>

    <!-- エリア -->
    <p>
      <label for="id_area">エリア（必須）</label>
      <input type="text" id="id_area" name="area"
             value="{{ object.area }}"
             list="area-list">
    </p>

    <datalist id="area-list">
      {% for item in area_list %}
        <option value="{{ item }}"></option>
      {% endfor %}
    </datalist>

    <!-- ジャンル -->
    <p>
      <label for="id_genre">ジャンル（必須）</label>
      <input type="text" id="id_genre" name="genre"
             value="{{ object.genre }}"
             list="genre-list">
    </p>

    <datalist id="genre-list">
      {% for item in genre_list %}
        <option value="{{ item }}"></option>
      {% endfor %}
    </datalist>

    <!-- グループ -->
    <p>
      <label for="id_companions">グループ</label>
      <input type="text" id="id_companions" name="companions"
             value="{{ object.companions }}"
             list="group-list">
    </p>

    <datalist id="group-list">
      {% for item in group_list %}
        <option value="{{ item }}"></option>
      {% endfor %}
    </datalist>

    <!-- シーン -->
    <p>
      <label for="id_scene">シーン</label>
      <input type="text" id="id_scene" name="scene"
             value="{{ object.scene }}"
             list="scene-list">
    </p>

    <datalist id="scene-list">
      {% for item in scene_list %}
        <option value="{{ item }}"></option>
      {% endfor %}
    </datalist>

<!-- 休業日（カスタムUI） -->
<!-- 休業日（カスタムUI） -->
<p>
  <label for="holiday-box">休業日</label>

  <div id="holiday-box" class="holiday-box"
     data-initial="{{ object.holiday|default:'' }}">
  <span class="holiday-text">選択してください</span>
  <span class="holiday-arrow">▼</span>
</div>
</p>


<!-- 選択肢リスト -->
<div id="holiday-options" class="holiday-options hidden">
  {% for value, label in form.fields.holiday.choices %}
    <div class="holiday-option" data-value="{{ value }}">{{ label }}</div>
  {% endfor %}
</div>

<div id="holiday-hidden-container"></div>


   <label class="tag-label">タグ</label>

<div id="tag-container">

  {% if selected_tags %}
    {% for tagname in selected_tags %}
      <div class="tag-row">
        <div class="input-with-arrow-tag">
          <input type="text" name="tags" class="tag-input"
                 value="{{ tagname }}"
                 placeholder="例：おしゃれ・個室など"
                 list="tag-list" autocomplete="on">
        </div>
      </div>
    {% endfor %}
  {% else %}
    <!-- タグが無い場合は1つ空欄 -->
    <div class="tag-row">
      <div class="input-with-arrow-tag">
        <input type="text" name="tags" class="tag-input"
               placeholder="例：おしゃれ・個室など"
               list="tag-list" autocomplete="on">
      </div>
    </div>
  {% endif %}

</div>

<button type="button" id="add-tag" class="add-tag-btn">＋ タグを追加</button>

</p>

<datalist id="tag-list">
  {% for item in tag_list %}
    <option value="{{ item }}"></option>
  {% endfor %}
</datalist>

<button type="submit">保存</button>

<div class="cancel-wrapper">
  {% if request.GET.from == "went" %}
    <!-- 行った詳細に戻る -->
    <a href="{% url 'restaurants:restaurant_detail_went' pk=object.pk %}" class="cancel-link">
      キャンセル
    </a>
  {% else %}
    <!-- 気になる詳細に戻る -->
    <a href="{% url 'restaurants:restaurant_detail' pk=object.pk %}" class="cancel-link">
      キャンセル
    </a>
  {% endif %}
</div>


</form>
</div>
{% endblock %}

{% block extra_js %}

<script src="{% static 'restaurants/js/register_suggest.js' %}"></script>

{% endblock %}
